{
  "projectName": "rica",
  "version": "2.0.1",
  "description": "React-based interactive visualization tool for multi-echo fMRI ICA component analysis",
  "lastUpdated": "2026-01-10",
  "modernizationNotes": "v2.0.0 - Upgraded to React 18, functional components, removed 5s loading delay, added progress indicator, Notion-style popups",
  "features": [
    {
      "id": "load_tedana_folder",
      "category": "data-loading",
      "description": "Load a tedana output folder containing metrics TSV, component PNGs, carpet SVGs, and report text files",
      "steps": [
        "Verify Notion-style intro popup appears centered on screen",
        "Click 'Select folder' button",
        "Select a tedana output directory via file picker",
        "Verify progress bar shows file processing",
        "Verify app transitions to tabbed view with loaded data"
      ],
      "passes": true
    },
    {
      "id": "display_info_tab",
      "category": "visualization",
      "description": "Display the Info tab showing tedana report text and source folder path",
      "steps": [
        "Load a tedana folder",
        "Click on the 'Info' tab",
        "Verify report text content is displayed",
        "Verify folder path is shown in header badge"
      ],
      "passes": false
    },
    {
      "id": "display_ica_scatter_plots",
      "category": "visualization",
      "description": "Display interactive scatter plots showing Kappa/Rho, Kappa/Rank, and Rho/Rank for ICA components",
      "steps": [
        "Load a tedana folder",
        "Navigate to the 'ICA' tab",
        "Verify three scatter plots are rendered (Kappa vs Rho, Kappa vs Rank, Rho vs Rank)",
        "Verify components are color-coded by classification (accepted=green, rejected=red)"
      ],
      "passes": false
    },
    {
      "id": "display_variance_pie_chart",
      "category": "visualization",
      "description": "Display a pie chart showing variance explained by each ICA component",
      "steps": [
        "Load a tedana folder",
        "Navigate to the 'ICA' tab",
        "Verify pie chart renders with component segments",
        "Verify segments are color-coded by classification",
        "Hover over segments to see variance percentage tooltips"
      ],
      "passes": false
    },
    {
      "id": "select_component_scatter",
      "category": "interactivity",
      "description": "Click on a scatter plot point to select a component and display its figure",
      "steps": [
        "Navigate to the 'ICA' tab with data loaded",
        "Click on any scatter plot point",
        "Verify the component figure image loads on the right panel",
        "Verify all scatter plots highlight the selected component",
        "Verify pie chart highlights the corresponding segment"
      ],
      "passes": false
    },
    {
      "id": "select_component_pie",
      "category": "interactivity",
      "description": "Click on a pie chart segment to select a component and display its figure",
      "steps": [
        "Navigate to the 'ICA' tab with data loaded",
        "Click on any pie chart segment",
        "Verify the component figure image loads on the right panel",
        "Verify all scatter plots highlight the selected component"
      ],
      "passes": false
    },
    {
      "id": "zoom_pan_scatter",
      "category": "interactivity",
      "description": "Zoom and pan scatter plots using mouse wheel and shift+drag",
      "steps": [
        "Navigate to the 'ICA' tab with data loaded",
        "Use mouse wheel to zoom in/out on any scatter plot",
        "Hold Shift and drag to pan the plot",
        "Drag to select a rectangular zoom area",
        "Verify zoom limits prevent going beyond original data bounds"
      ],
      "passes": false
    },
    {
      "id": "reclassify_component_toggle",
      "category": "interactivity",
      "description": "Manually reclassify a component using the toggle switch (accepted/rejected)",
      "steps": [
        "Select a component on scatter or pie chart",
        "Click on the classification toggle switch (Accepted/Rejected)",
        "Verify component color updates across all plots",
        "Verify toggle switch reflects new classification"
      ],
      "passes": false
    },
    {
      "id": "reclassify_component_keyboard",
      "category": "interactivity",
      "description": "Use keyboard shortcuts to reclassify components (A=accept, R=reject)",
      "steps": [
        "Select a component",
        "Press 'A' key to accept component",
        "Verify component turns green across all plots",
        "Press 'R' key to reject component",
        "Verify component turns red across all plots"
      ],
      "passes": false
    },
    {
      "id": "navigate_components_keyboard",
      "category": "interactivity",
      "description": "Navigate between components using left/right arrow keys",
      "steps": [
        "Select a component in scatter or pie chart",
        "Press left arrow to move to previous component (by rank)",
        "Verify new component is highlighted and figure updates",
        "Press right arrow to move to next component",
        "Verify component selection follows rank order in scatter mode and pie order in pie mode"
      ],
      "passes": false
    },
    {
      "id": "reset_classifications",
      "category": "interactivity",
      "description": "Reset all manual classifications back to original tedana values",
      "steps": [
        "Make one or more manual classification changes",
        "Click the 'Reset' button",
        "Verify all components revert to their original classifications",
        "Verify plot colors reflect original state"
      ],
      "passes": false
    },
    {
      "id": "save_manual_classification",
      "category": "export",
      "description": "Export manually reclassified components as TSV file and separate accepted/rejected text files",
      "steps": [
        "Make one or more manual classification changes",
        "Click the 'Save' button",
        "Verify manual_classification.tsv downloads with updated classifications",
        "Verify accepted.txt downloads with indices of manually accepted components",
        "Verify rejected.txt downloads with indices of manually rejected components",
        "Verify classification_tags and rationale fields are updated for changed components"
      ],
      "passes": false
    },
    {
      "id": "display_carpet_plots",
      "category": "visualization",
      "description": "Display carpet plots from tedana SVG output files",
      "steps": [
        "Load a tedana folder",
        "Navigate to the 'Carpets' tab",
        "Verify first carpet plot SVG is displayed",
        "Verify dropdown menu lists all available carpet plots"
      ],
      "passes": false
    },
    {
      "id": "switch_carpet_plot",
      "category": "interactivity",
      "description": "Switch between different carpet plot visualizations using dropdown",
      "steps": [
        "Navigate to the 'Carpets' tab with data loaded",
        "Click the dropdown menu",
        "Select a different carpet plot option",
        "Verify the displayed image updates to show selected carpet plot"
      ],
      "passes": false
    },
    {
      "id": "load_new_session",
      "category": "ui",
      "description": "Load a new tedana folder without reloading the page",
      "steps": [
        "Have a session already loaded",
        "Click the 'New' button in the header",
        "Verify intro popup appears",
        "Select a new folder",
        "Verify data is replaced with new folder contents"
      ],
      "passes": false
    },
    {
      "id": "show_about_popup",
      "category": "ui",
      "description": "Display the About popup with version and GitHub link",
      "steps": [
        "Click the 'About' button in the header",
        "Verify Notion-style popup appears centered on screen",
        "Verify version number (v2.0.0) is displayed",
        "Verify 'View on GitHub' button is present and clickable",
        "Click outside popup or X button to close"
      ],
      "passes": true
    },
    {
      "id": "animated_tab_navigation",
      "category": "ui",
      "description": "Navigate between tabs (Info, ICA, Carpets) with animated underline indicator",
      "steps": [
        "Have data loaded and tabs visible",
        "Click on 'Info' tab",
        "Verify blue underline animates to Info tab",
        "Click on 'ICA' tab",
        "Verify underline animates smoothly to ICA tab",
        "Click on 'Carpets' tab",
        "Verify underline animates to Carpets tab"
      ],
      "passes": false
    },
    {
      "id": "mobile_fallback",
      "category": "ui",
      "description": "Show mobile-friendly fallback message on screens narrower than 1024px",
      "steps": [
        "Open application on a device/window with width < 1024px",
        "Verify mobile fallback view is displayed instead of main app",
        "Verify message asks user to visit from a computer",
        "Verify 'Learn more' link to GitHub is present"
      ],
      "passes": false
    },
    {
      "id": "dynamic_page_title",
      "category": "ui",
      "description": "Update browser tab title to show the loaded data folder path",
      "steps": [
        "Load a tedana folder",
        "Check browser tab title",
        "Verify title shows the folder path extracted from tedana metadata"
      ],
      "passes": false
    },
    {
      "id": "component_tooltips",
      "category": "visualization",
      "description": "Display tooltips with component details on chart hover",
      "steps": [
        "Navigate to 'ICA' tab with data loaded",
        "Hover over a scatter plot point",
        "Verify tooltip shows component name and metric value",
        "Hover over a pie chart segment",
        "Verify tooltip shows component name and variance percentage"
      ],
      "passes": false
    },
    {
      "id": "production_build",
      "category": "infrastructure",
      "description": "Build production bundle with inlined CSS and JS for single-file distribution",
      "steps": [
        "Run 'npm run build'",
        "Run gulp default task to inline assets",
        "Verify build/index.html contains inlined JavaScript and CSS",
        "Open build/index.html in browser",
        "Verify application works as single-file deployment"
      ],
      "passes": false
    },
    {
      "id": "tailwind_jit_compilation",
      "category": "infrastructure",
      "description": "Compile Tailwind CSS with JIT mode for development and production",
      "steps": [
        "Run 'npm run watch:css' for development",
        "Verify src/styles/output.css is generated",
        "Modify a component to use a new Tailwind class",
        "Verify the class is compiled into output.css"
      ],
      "passes": false
    },
    {
      "id": "display_brain_stat_map",
      "category": "visualization",
      "description": "Display interactive brain stat map mosaic using Niivue for selected ICA component",
      "steps": [
        "Load a tedana folder containing *stat-z_components.nii.gz",
        "Navigate to the 'ICA' tab",
        "Verify brain viewer displays 3 rows of slices (axial, sagittal, coronal) with 7 slices per row",
        "Verify warm/cool diverging colormap is applied (warm for positive, cool for negative)",
        "Verify colormap range is set to 25% of max absolute value by default",
        "Select different components and verify brain map updates"
      ],
      "passes": true
    },
    {
      "id": "ica_brain_map_position_slider",
      "category": "interactivity",
      "description": "Navigate through brain slices using position slider in ICA tab",
      "steps": [
        "Load a tedana folder containing NIfTI files",
        "Navigate to the 'ICA' tab",
        "Locate the Position slider below the brain viewer",
        "Drag slider to navigate through brain slices (-40% to +40%)",
        "Verify mosaic view updates in real-time as slider moves",
        "Verify percentage label updates to show current position"
      ],
      "passes": true
    },
    {
      "id": "adjust_colormap_saturation",
      "category": "interactivity",
      "description": "Adjust brain stat map colormap saturation using slider control",
      "steps": [
        "Load a tedana folder with NIfTI files",
        "Navigate to the 'ICA' tab",
        "Locate the saturation slider below the brain viewer",
        "Drag slider to adjust saturation (1% to 100%)",
        "Verify brain map updates in real-time as slider moves",
        "Verify percentage label updates to show current value"
      ],
      "passes": true
    },
    {
      "id": "display_time_series",
      "category": "visualization",
      "description": "Display interactive time series plot for selected ICA component from mixing matrix",
      "steps": [
        "Load a tedana folder containing *_mixing.tsv",
        "Navigate to the 'ICA' tab",
        "Verify time series chart displays above brain viewer",
        "Verify line color matches component classification (green=accepted, red=rejected)",
        "Hover to see TR and value tooltips",
        "Use scroll to zoom and drag to pan"
      ],
      "passes": true
    },
    {
      "id": "display_fft_spectrum",
      "category": "visualization",
      "description": "Display FFT power spectrum for selected ICA component time series",
      "steps": [
        "Load a tedana folder containing *_mixing.tsv",
        "Navigate to the 'ICA' tab",
        "Verify FFT spectrum chart displays below brain viewer",
        "Verify line color matches component classification",
        "Verify X-axis shows frequency (cycles/TR) and Y-axis shows power",
        "Hover to see frequency and power tooltips"
      ],
      "passes": true
    },
    {
      "id": "synchronized_component_views",
      "category": "interactivity",
      "description": "All visualizations update synchronously when selecting a different component",
      "steps": [
        "Load a tedana folder with mixing matrix and NIfTI files",
        "Select a component from scatter plot or pie chart",
        "Verify brain stat map updates to show selected component volume",
        "Verify time series updates to show selected component",
        "Verify FFT spectrum updates based on new time series",
        "Verify all views reflect component classification color"
      ],
      "passes": true
    },
    {
      "id": "fallback_png_display",
      "category": "visualization",
      "description": "Fall back to static PNG display when NIfTI/mixing files are not available",
      "steps": [
        "Load a tedana folder without mixing TSV or NIfTI files",
        "Navigate to the 'ICA' tab",
        "Verify static PNG component images are displayed instead of interactive views",
        "Verify component selection still updates displayed PNG"
      ],
      "passes": true
    },
    {
      "id": "display_component_table",
      "category": "visualization",
      "description": "Display interactive component metrics table with full data from metrics TSV file",
      "steps": [
        "Load a tedana folder",
        "Navigate to the 'ICA' tab",
        "Verify component metrics table appears below the charts",
        "Verify table shows columns: Component, Kappa, Rho, Variance, Ranks, Dice scores, S/N, Classification, Tags",
        "Verify table is scrollable for large datasets"
      ],
      "passes": true
    },
    {
      "id": "table_chart_sync",
      "category": "interactivity",
      "description": "Synchronize selection between component table and charts",
      "steps": [
        "Load a tedana folder",
        "Click on a row in the component table",
        "Verify all charts update to highlight the selected component",
        "Click on a point in a scatter plot or pie chart",
        "Verify the table auto-scrolls to and highlights the selected row"
      ],
      "passes": true
    },
    {
      "id": "table_classification_update",
      "category": "interactivity",
      "description": "Update table classification when reclassifying components",
      "steps": [
        "Load a tedana folder",
        "Select a component from the table or charts",
        "Use A/R keys or toggle switch to change classification",
        "Verify the table row highlight color changes (green for accepted, red for rejected)",
        "Verify the classification badge in the table updates"
      ],
      "passes": true
    },
    {
      "id": "modern_navbar",
      "category": "ui",
      "description": "Display modern Notion-style navbar with logo, pill tabs, and action buttons",
      "steps": [
        "Load data and view the navbar",
        "Verify favicon logo appears next to 'Rica' text",
        "Verify version badge (v2.0) is displayed",
        "Verify tabs are in pill-style container with gray background",
        "Verify selected tab has white background",
        "Verify New and About buttons have modern styling"
      ],
      "passes": true
    },
    {
      "id": "click_outside_close_popup",
      "category": "ui",
      "description": "Close popups by clicking outside the modal card",
      "steps": [
        "Click 'New' button to open intro popup",
        "Click outside the white card (on the gray backdrop)",
        "Verify popup closes",
        "Click 'About' button to open about popup",
        "Click outside the white card",
        "Verify popup closes"
      ],
      "passes": true
    },
    {
      "id": "display_data_path",
      "category": "visualization",
      "description": "Display the correct output directory path in the Info tab",
      "steps": [
        "Load a tedana folder",
        "Navigate to the 'Info' tab",
        "Verify the output directory path is displayed in the blue badge",
        "Verify the path matches the 'Using output directory' from tedana log"
      ],
      "passes": true
    },
    {
      "id": "formatted_component_names",
      "category": "ui",
      "description": "Display component names with spaces instead of underscores (ICA 01 instead of ICA_01)",
      "steps": [
        "Load a tedana folder",
        "Hover over scatter plot points to see tooltips",
        "Verify component names show as 'ICA 01' not 'ICA_01'",
        "Check pie chart tooltips, component table, and brain viewer title",
        "Save manual classifications and verify original names (with underscores) are preserved"
      ],
      "passes": true
    },
    {
      "id": "sticky_table_header",
      "category": "ui",
      "description": "Component table header stays visible when scrolling through rows",
      "steps": [
        "Load a tedana folder with many components",
        "Navigate to the ICA tab",
        "Scroll down in the component metrics table",
        "Verify the header row stays fixed at the top",
        "Verify column labels remain visible while scrolling"
      ],
      "passes": true
    },
    {
      "id": "improved_pie_hover",
      "category": "interactivity",
      "description": "Pie chart hover works smoothly without flickering",
      "steps": [
        "Load a tedana folder",
        "Navigate to the ICA tab",
        "Hover over different pie chart segments",
        "Verify tooltip appears reliably without flickering",
        "Verify hovered segment shows gray border highlight",
        "Verify moving between segments updates smoothly"
      ],
      "passes": true
    },
    {
      "id": "wraparound_navigation",
      "category": "interactivity",
      "description": "Arrow key navigation wraps around the pie chart continuously",
      "steps": [
        "Load a tedana folder",
        "Navigate to the ICA tab",
        "Select a component and use right arrow to navigate",
        "Continue pressing right arrow past the last component",
        "Verify navigation wraps to the first component",
        "Press left arrow to navigate backwards",
        "Verify navigation wraps from first to last component"
      ],
      "passes": true
    },
    {
      "id": "pie_selection_no_displacement",
      "category": "visualization",
      "description": "Selected pie chart slice appears on top without being displaced",
      "steps": [
        "Load a tedana folder",
        "Navigate to the ICA tab",
        "Click on different pie chart segments",
        "Verify selected segment stays in its original position",
        "Verify selected segment appears on top of neighbors",
        "Verify selection is indicated by dark border and shadow"
      ],
      "passes": true
    },
    {
      "id": "display_qc_brain_maps",
      "category": "visualization",
      "description": "Display interactive QC brain maps (T2*, S0, RMSE) using Niivue mosaic view",
      "steps": [
        "Load a tedana folder containing T2starmap.nii, S0map.nii, rmse_statmap.nii",
        "Navigate to the 'QC' tab",
        "Verify 'Brain Maps' category is selected by default",
        "Verify T2*, S0, and RMSE map tabs are available",
        "Verify brain map displays 3 rows (axial, sagittal, coronal) with 7 slices each",
        "Click between T2*, S0, and RMSE tabs to switch maps"
      ],
      "passes": true
    },
    {
      "id": "qc_brain_map_controls",
      "category": "interactivity",
      "description": "Adjust QC brain map display using position and contrast sliders",
      "steps": [
        "Navigate to the 'QC' tab with Brain Maps selected",
        "Locate the Position slider and drag to navigate through brain slices",
        "Verify mosaic updates to show different slice positions",
        "Locate the Contrast slider and drag to adjust colormap intensity",
        "Verify brain map contrast changes in real-time",
        "Switch to a different map and verify contrast resets to 50%"
      ],
      "passes": true
    },
    {
      "id": "qc_rmse_colormap",
      "category": "visualization",
      "description": "RMSE map uses inverted hot colormap with black background outside brain",
      "steps": [
        "Navigate to the 'QC' tab",
        "Select the RMSE Map tab",
        "Verify hot colormap is applied (black to red to yellow to white)",
        "Verify areas outside the brain appear black due to colormap inversion",
        "Verify high RMSE values inside brain appear as hot colors"
      ],
      "passes": true
    },
    {
      "id": "display_qc_histograms",
      "category": "visualization",
      "description": "Display histogram SVG figures in QC tab",
      "steps": [
        "Load a tedana folder containing histogram SVG files",
        "Navigate to the 'QC' tab",
        "Click on 'Histograms' category tab",
        "Verify histogram figures are displayed",
        "If multiple histograms exist, verify sub-selector tabs appear",
        "Click between histogram tabs to switch displayed figure"
      ],
      "passes": true
    },
    {
      "id": "display_qc_time_series",
      "category": "visualization",
      "description": "Display time series SVG figures in QC tab",
      "steps": [
        "Load a tedana folder containing time series SVG files",
        "Navigate to the 'QC' tab",
        "Click on 'Time Series' category tab",
        "Verify time series figures are displayed",
        "If multiple figures exist, verify sub-selector tabs appear"
      ],
      "passes": true
    },
    {
      "id": "scatter_plot_reference_lines",
      "category": "visualization",
      "description": "Display elbow threshold lines and reference lines on scatter plots",
      "steps": [
        "Load a tedana folder containing *_desc-ICACrossComponent_metrics.json",
        "Navigate to the 'ICA' tab",
        "Verify Kappa vs Rho plot shows vertical kappa elbow line and horizontal rho elbow line",
        "Verify Kappa vs Rho plot shows diagonal x=y reference line",
        "Verify Kappa Rank plot shows horizontal kappa elbow line and connecting line through points",
        "Verify Rho Rank plot shows horizontal rho elbow line and connecting line through points"
      ],
      "passes": true
    },
    {
      "id": "display_external_regressor_correlations",
      "category": "visualization",
      "description": "Display external regressor correlation figure in QC tab when available",
      "steps": [
        "Load a tedana folder generated with external regressors (contains confound_correlations.svg)",
        "Navigate to the 'QC' tab",
        "Verify 'External Regressors' category tab appears",
        "Click on 'External Regressors' category",
        "Verify confound correlations figure is displayed",
        "Verify the figure shows correlation matrix between external regressors and ICA components"
      ],
      "passes": true
    },
    {
      "id": "interactive_external_regressor_heatmap",
      "category": "visualization",
      "description": "Display interactive correlation heatmap in ICA tab for external regressors",
      "steps": [
        "Load tedana folder generated with external regressors (tedana PR #1297+)",
        "Navigate to the 'ICA' tab",
        "Verify correlation heatmap appears below the component table",
        "Verify heatmap shows components (rows) vs external regressors (columns)",
        "Verify diverging color scale: blue (negative) -> white (zero) -> red (positive)",
        "Verify colorbar is positioned to the right of the heatmap",
        "Hover over cells to see correlation values in tooltip",
        "Click cells to select corresponding component (syncs with all charts)",
        "Falls back to static SVG if correlation columns not in metrics TSV"
      ],
      "passes": true
    },
    {
      "id": "toggle_interactive_static_view",
      "category": "interactivity",
      "description": "Toggle between interactive Niivue brain maps and static PNG component images",
      "steps": [
        "Load a tedana folder containing NIfTI and mixing matrix files",
        "Navigate to the 'ICA' tab",
        "Verify 'Interactive' and 'Static' toggle buttons appear above the brain viewer",
        "Click 'Static' button to switch to static PNG display",
        "Verify component image displays as static PNG instead of Niivue viewer",
        "Click 'Interactive' button to switch back to Niivue + time series + FFT display",
        "Verify interactive views are restored with brain mosaic, time series, and spectrum"
      ],
      "passes": true
    },
    {
      "id": "collapsible_component_table",
      "category": "ui",
      "description": "Collapse/expand the component metrics table to reduce auto-scroll distraction",
      "steps": [
        "Load a tedana folder",
        "Navigate to the 'ICA' tab",
        "Verify 'Component Metrics' header has a chevron icon and component count",
        "Click on the header to collapse the table",
        "Verify chevron rotates and table smoothly collapses (height transitions to 0)",
        "Select a component from pie chart while table is collapsed",
        "Verify page does NOT auto-scroll to table (distraction eliminated)",
        "Click header again to expand the table",
        "Verify table re-appears with smooth transition"
      ],
      "passes": true
    },
    {
      "id": "compact_layout",
      "category": "ui",
      "description": "Compact layout with reduced chart dimensions for better screen fit",
      "steps": [
        "Load a tedana folder",
        "Navigate to the 'ICA' tab",
        "Verify scatter plots and pie chart use reduced dimensions (360x320px)",
        "Verify brain viewer, time series, and FFT use reduced dimensions",
        "Verify right panel uses responsive 50% width instead of fixed 800px",
        "Verify overall page height is reduced to better fit standard 1080p screens"
      ],
      "passes": true
    }
  ]
}
